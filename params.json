{"name":"wlister","tagline":"Web application firewall designed to whitelist and/or blacklist HTTP requests. ","body":"# Introduction\r\n\r\n ``` wlister ``` is a web application firewall (WAF) allowing web application protection based on whitelisting and attacks signature. The former is used to quickly validating an authorized and well formed request. The latter is used to detect known attacks patterns into HTTP requests. \r\n \r\nUsing ```wlister``` it is possible to apply both methods and to combine them at will. \r\n\r\n ```wlister``` allows to describe interactions between the web application and the client, using each piece of a HTTP request and their combination as a potential validation point (URI, parameters, headers, content, method, protocol, ...).\r\n\r\n\r\n# How it works\r\n\r\nEach incoming request is analyzed using a set of rules. A rule has pre-conditions that must be fulfilled to be applied against the request. If pre-conditions are satisfied (reps. not satisfied), rule is applied (resp. next rule is used). \"Rule is applied\" means pattern matching is executed against some part of the request. \r\n\r\nDepending on the matching results (match or mismatch), actions can be specified. For now, there are 3 actions:\r\n \r\n- tagging/untagging the request for next rule analysis\r\n- whitelisting \r\n- blacklisting\r\n\r\nWhitelisting and blacklisting terminate the request analysis. Tagging/untagging is useful to build smart pre-conditions, avoiding rules being applied whereas they are not related at all (*e.g.* HTTP request for static content must not be checked by rules dedicated to the authentication process nor any other rule). \r\n\r\nRule configuration file used for unit test use all available features. \r\n\r\n# Requirements\r\n\r\n## Librairies\r\n\r\n ```wlister``` is using [ ```jsonschema``` ](https://pypi.python.org/pypi/jsonschema) library to match JSON content in HTTP requests and to validate the whole ruleset.\r\nIt is expressed in ```requirements.txt``` and is installable using pypi.\r\n\r\n\r\n## Software\r\n\r\nCurrent version is tested with ```Apache``` and ```mod_python``` on ```Ubuntu 12.04 LTS```.\r\n\r\n```\r\n$ sudo dpkg -l | grep apache2\r\nii  apache2                   2.2.22-1ubuntu1.4      Apache HTTP Server metapackage\r\nii  apache2-mpm-prefork       2.2.22-1ubuntu1.4      Apache HTTP Server - traditional non-threaded model\r\n```\r\n\r\n```\r\n$ sudo dpkg -l | grep mod-python\r\nii  libapache2-mod-python     3.3.1-9ubuntu1         Python-embedding module for Apache 2\r\n```\r\n\r\n```\r\n$ cat /etc/lsb-release \r\nDISTRIB_ID=Ubuntu\r\nDISTRIB_RELEASE=12.04\r\nDISTRIB_CODENAME=precise\r\nDISTRIB_DESCRIPTION=\"Ubuntu 12.04.4 LTS\"\r\n```\r\n\r\n ```mod_python``` is supposed to be dead, but it is used for now (not as WSGI). Plus it seems to be not that dead, see:\r\n\r\n* [mod_python - Home Page] (http://modpython.org/)\r\n* [mod_python - The Long Story] (http://grisha.org/blog/2013/10/25/mod-python-the-long-story/)\r\n\r\n\r\n# Pros\r\n\r\n```wlister``` allows can analyze any part of a HTTP request, headers and body, in a handy way, focusing only on the interesting part. \r\n\r\nRule pre-conditions, tagging and action if (mis)match imply only necessary rules are applied and decision is done quickly; allowed or denied. \r\n\r\n```wlister``` try and use lazy evaluation to avoid transforming data that may never be used (but this is local optimization and must be measured). \r\n\r\n# Cons\r\n\r\n ```wlister``` is based on ```mod_python``` and Apache. This is not bad *per se* but because it is a Python application. Surely not fast enough although no benchmark have been done so far.\r\n \r\n ```wlister``` is based on ```mod_python``` and Apache, so it can not be used within another web server/proxy. \r\n\r\n# What is missing ?\r\n\r\n**Documentation** There are some stuff in ```doc/```. Rules documentation is outdated for sure. But what is implemented is tested so there are readable examples from  ```conf/rules.conf``` and ```tests/*.py```.\r\n\r\n**Logging** It exists but it is not nice enough. It can be very useful to have logging format used for advanced debug/configuration and logging format to raise an alert. Another format to... whatever. Logging facilities with formatting has to be implemented. \r\n\r\n**Attack signatures** No signature here, but I guess mod_security signatures database can help.\r\n\r\n**Documentation** Rules file used for unit tests can really help, but all rule directives must be documented at some point.\r\n\r\n**Code review** One dev, one dev. But there are tests (see ```tests/*.py```)\r\n\r\n**Refactoring** Matching directives are hard coded. Having a new one means developing it and binding stuff through the code which is error prone. Someone will want a new one, so it'd better be easy.\r\n\r\n**Learning module** Inferring patterns, finding invariants/constants, ...\r\n\r\n# Licensing\r\n\r\nCopyright (c) 2014, Elvis Tombini <elvis_at_mapom.me>\r\n\r\nPermission to use, copy, modify, and distribute this software for any\r\npurpose with or without fee is hereby granted, provided that the above\r\ncopyright notice and this permission notice appear in all copies.\r\n\r\nTHE SOFTWARE IS PROVIDED \"AS IS\" AND THE AUTHOR DISCLAIMS ALL WARRANTIES\r\nWITH REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF\r\nMERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR\r\nANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES\r\nWHATSOEVER RESULTING FROM LOSS OF USE, DATA OR PROFITS, WHETHER IN AN\r\nACTION OF CONTRACT, NEGLIGENCE OR OTHER TORTIOUS ACTION, ARISING OUT OF\r\nOR IN CONNECTION WITH THE USE OR PERFORMANCE OF THIS SOFTWARE.\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}